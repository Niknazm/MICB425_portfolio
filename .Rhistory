install.packages("tidyverse")
#Comments
install.packages("tidyverse")
library(tidyverse)
OTU = read.table(file="Saanich.OTU.txt" , header=True, row.names=1, sep="\t", na.strings =c("NAN", "NA", "."))
OTU = read.table(file="Saanich.OTU.txt" , header=True, row.names=1, sep="\t", na.strings =c("NAN", "NA", "."))
OTU = read.table(file="Saanich.OTU.txt" , header=True, row.names=1, sep="\t", na.strings =c("NAN", "NA", "."))
OTU = read.table(file="Saanich.OTU.txt" , header=True, row.names=1, sep="\t", na.strings =c("NAN", "NA", "."))
OTU = read.table(file="Saanich.OTU.txt", header=True, row.names=1, sep="\t", na.strings =c("NAN", "NA", "."))
OTU = read.table(file="Saanich.OTU.txt", header=TRUE, row.names=1, sep="\t", na.strings =c("NAN", "NA", "."))
View(OTU)
View(OTU)
metadata = read.table(file="Saanich.metadata.txt" , header=True, row.names=1, sep="\t", na.strings =c("NAN", "NA", "."))
metadata = read.table(file="Saanich.metadata.txt", header=TRUE, row.names=1, sep="\t", na.strings =c("NAN", "NA", "."))
View(metadata)
View(metadata)
View(metadata)
metadata %>%
select(matches(CH4|methane)) %>%
metadata %>%
filter(CH4_nM>100)
metadata %>%
select(matches(Temperature_C)) %>%
metadata %>%
filter(Temperature_C>10)
metadata %>%
select(matches(CH4|methane)) %>%
filter(CH4_nM>100)
select(matches(Temperature_C)) %>%
filter(Temperature_C>10)
metadata %>%
select(matches(CH4|methane)) %>%
filter(CH4_nM>100)%>%
metadata %>%
matches(Temperature_C)) %>%
filter(Temperature_C>10) %>%
metadata %>%
filter(CH4_nM>100)%>%
filter(Temperature_C>10) %>%
metadata %>%
filter(CH4_nM>100)%>%
filter(Temperature_C>10) %>%
metadata %>%
select(matches(CH4|methane|nM)%>%
select(matches(CH4|methane|nM)%>%
select(matches("CH4|methane")
#exercise:find at what deoth methane is above 100 nM while temperature is below 10
metadata %>%
select(matches("CH4|methane"))
metadata %>%
select(matches("CH4|methane"))
metadata %>%
select(matches("CH4|methane"))
View(metadata)
View(metadata)
metadata %>%
select(matches("CH4|methane"))
metadata %>%
filter(CH4_nM>100) %>%
filter(Temperature_C <10)
select(Depth_m,CH4_nM, Temperature_C)
library("tidyverse", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
metadata %>%
filter(CH4_nM>100) %>%
filter(Temperature_C <10)
select(Depth_m,CH4_nM, Temperature_C)
filter(CH4_nM>100) %>%
filter(Temperature_C <10) %>%
select(Depth_m,CH4_nM, Temperature_C)
ggplot(table_1, aes(x=Depth_m, y=Concentration)) +
geom_point() + geom_line() + facet_wrap(~Nutrients, scales="free_y") +
theme(legend.position= "none")
library(tidyverse)
library(phyloseq)
source("https://bioconductor.org/biocLite.R")
ggplot(table_1, aes(x=Depth_m, y=Concentration)) +
geom_point() + geom_line() + facet_wrap(~Nutrients, scales="free_y") +
theme(legend.position= "none")
table= metadata
ggplot(table_1, aes(x=Depth_m, y=Concentration)) +
geom_point() + geom_line() + facet_wrap(~Nutrients, scales="free_y") +
theme(legend.position= "none")
table_1= table %>%
gather(Nutrients, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)
ggplot(table_1, aes(x=Depth_m, y=Concentration)) +
geom_point() + geom_line() + facet_wrap(~Nutrients, scales="free_y") +
theme(legend.position= "none")
knitr::opts_chunk$set(echo = TRUE)
load("phyloseq_object.RData")
load("phyloseq_object.RData")
load("phyloseq_object.RData")
library(phyloseq)
library(phyloseq)
install.packages(phyloseq)
library(phyloseq)
library(phyloseq)
load("phyloseq_object.RData")
source("https://bioconductor.org/biocLite.R")
biocLite("phyloseq")
ggplot(table_1, aes(x=Depth_m, y=Concentration)) +
geom_point() + geom_line() + facet_wrap(~Nutrients, scales="free_y") +
theme(legend.position= "none")
```{r}
library(tidyverse)
library(tidyverse)
library(phyloseq)
ggplot(metadata, aes(x=PO4_uM, y=Depth_m)) +
geom_point(color="purple") + geom_point(shape=17)
knitr::opts_chunk$set(echo = TRUE)
metadata %>%
mutate(Temperature_F= Temperature_C*9/5+32)
metadata %>%
mutate(Temperature_F= Temperature_C*9/5+32) %>%
ggplot() + geom_point(aes(x=Temperature_F, y=Depth_m))
ggplot(metadata, aes(x=PO4_uM, y=Depth_m)) +
geom_point(color="purple") + geom_point(shape=17)
plot_bar(physeq_percent, fill="Phylum",  title="Phyla from 10 to 200 m in Saanich Inlet") +
geom_bar(aes(fill=Phylum), stat="identity") + labs(x="Sample depth", y="percent relative abundance")
plot_bar(physeq_percent, fill="Phylum",  title="Phyla from 10 to 200 m in Saanich Inlet") +
geom_bar(aes(fill=Phylum), stat="identity") + labs(x="Sample depth", y="percent relative abundance")
plot_bar(physeq_percent, fill="Phylum",  title="Phyla from 10 to 200 m in Saanich Inlet") +
geom_bar(aes(fill=Phylum), stat="identity") + labs(x="Sample depth", y="percent relative abundance")
plot_bar (physeq_percent, fill="Phylum",  title="Phyla from 10 to 200 m in Saanich Inlet") +
geom_bar(aes(fill=Phylum), stat="identity") + labs(x="Sample depth", y="percent relative abundance")
plot_bar(physeq_percent, fill="Phylum") +
geom_bar(aes(fill=Phylum), stat="identity") +
facet_wrap(~Phylum, scales="free_y") +
theme(legend.position="none")
library(tidyverse)
library(phyloseq)
library(tidyverse)
library(phyloseq)
load("phyloseq_object.RData")
plot_bar(physeq, fill="Phylum")
plot_bar(physeq, fill="Phylum")
library(phyloseq)
load("phyloseq_object.RData")
plot_bar(physeq_percent, fill="Phylum") +
geom_bar(aes(fill=Phylum), stat="identity")
> load("phyloseq_object.RData")
#Exercise 3
plot_bar(physeq_percent, fill="Phylum",  title="Phyla from 10 to 200 m in Saanich Inlet") +
geom_bar(aes(fill=Phylum), stat="identity") + labs(x="Sample depth", y="percent relative abundance")
load("phyloseq_object.RData")\
library(phyloseq)
load("phyloseq_object.RData")
